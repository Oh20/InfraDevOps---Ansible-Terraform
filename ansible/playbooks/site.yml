---
- name: Testar conectividade WinRM
  hosts: all
  gather_facts: no
  
  tasks:
    - name: Ping Windows
      ansible.windows.win_ping:
      
    - name: Obter informações do sistema
      ansible.windows.win_shell: |
        Write-Output "Hostname: $env:COMPUTERNAME"
        Write-Output "Usuario: $env:USERNAME"
        Write-Output "OS: $(Get-CimInstance Win32_OperatingSystem | Select-Object -ExpandProperty Caption)"
      register: system_info
      
    - name: Mostrar informações
      debug:
        msg: "{{ system_info.stdout_lines }}"